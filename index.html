<!DOCTYPE html>
<html lang="en" class="">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive Chatbot</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script>
    // Sync Tailwind dark mode with system and allow manual override
    function applyTheme(theme) {
      if (theme === 'dark') {
        document.documentElement.classList.add('dark');
      } else {
        document.documentElement.classList.remove('dark');
      }
    }
    function getPreferredTheme() {
      if (localStorage.getItem('theme')) {
        return localStorage.getItem('theme');
      }
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }
    function syncTheme() {
      applyTheme(getPreferredTheme());
    }
    // Initial sync
    syncTheme();
    // Listen for system theme changes
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
      if (!localStorage.getItem('theme')) {
        applyTheme(e.matches ? 'dark' : 'light');
      }
    });
  </script>
</head>
<body class="relative bg-gray-100 dark:bg-gray-900 flex items-center justify-center min-h-screen overflow-hidden">
  <!-- Animated background -->
  <div id="bg-effect" class="absolute inset-0 -z-10">
    <canvas id="bg-canvas" class="w-full h-full"></canvas>
    <div id="bg-color" class="absolute inset-0 transition-colors duration-700"></div>
  </div>
  <div class="w-full max-w-2xl mx-auto bg-white dark:bg-gray-900 rounded-3xl shadow-2xl p-0 flex flex-col h-[90vh] min-h-[600px] border border-blue-100 dark:border-gray-700 relative z-10 backdrop-blur-md">
  <div class="bg-gradient-to-r from-blue-500 to-indigo-500 dark:from-gray-800 dark:to-gray-700 rounded-t-3xl p-6 flex items-center justify-between shadow-md">
      <div class="flex items-center">
        <svg class="w-8 h-8 text-white mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M17 8h2a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2v-8a2 2 0 012-2h2M12 12v.01M12 16h.01M8 12h.01M16 12h.01"/></svg>
        <h2 class="text-2xl font-bold text-white tracking-wide">Chatbot</h2>
      </div>
      <div class="flex items-center gap-2">
  <!-- Removed clear chat button -->
        <button id="delete-history" title="Delete all chat history" class="bg-white dark:bg-gray-800 border border-blue-200 dark:border-gray-600 rounded-full p-2 shadow hover:bg-red-100 dark:hover:bg-gray-700 transition-all">
          <svg class="w-6 h-6 text-red-700" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M1 7h22M10 3h4a1 1 0 011 1v2H9V4a1 1 0 011-1z"/>
          </svg>
        </button>
        <button id="theme-toggle" title="Toggle dark mode" class="bg-white dark:bg-gray-800 border border-blue-200 dark:border-gray-600 rounded-full p-2 shadow hover:bg-blue-100 dark:hover:bg-gray-700 transition-all">
          <svg id="theme-icon" class="w-6 h-6 text-blue-500 dark:text-yellow-300" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path id="theme-icon-path" stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m8.66-13.66l-.71.71M4.05 19.07l-.71.71M21 12h-1M4 12H3m16.66 5.66l-.71-.71M4.05 4.93l-.71-.71M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
          </svg>
        </button>
      </div>
    </div>
  <div id="chat-window" class="flex-1 overflow-y-auto mb-0 p-6 bg-gray-50 dark:bg-gray-800 rounded-b-3xl border-t border-gray-200 dark:border-gray-700 custom-scrollbar space-y-4" style="max-height: 60vh; min-height: 200px;"></div>
    <form id="chat-form" class="flex gap-2 p-6 bg-white dark:bg-gray-900 border-t border-gray-100 dark:border-gray-700 rounded-b-3xl">
      <input id="user-input" type="text" placeholder="Type your message..." class="flex-1 px-5 py-3 border-2 border-blue-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-400 dark:focus:ring-yellow-400 transition-all duration-200 shadow-md text-lg" autocomplete="off" required />
      <button type="submit" class="bg-gradient-to-r from-blue-500 to-indigo-500 dark:from-gray-700 dark:to-gray-800 text-white px-8 py-3 rounded-full font-semibold shadow-lg hover:from-blue-600 hover:to-indigo-600 dark:hover:from-gray-600 dark:hover:to-gray-900 transition-all duration-200 text-lg">Send</button>
    </form>
  </div>
  <style>
    /* Animated gradient background */
    @keyframes gradient-move {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    .animate-gradient-move {
      background-size: 200% 200%;
      animation: gradient-move 12s ease-in-out infinite;
    }
    /* Particle animation for canvas */
    #bg-canvas {
      position: absolute;
      top: 0; left: 0; width: 100vw; height: 100vh;
      display: block;
      pointer-events: none;
      z-index: 0;
    }
    /* Custom scrollbar for chat window */
    .custom-scrollbar::-webkit-scrollbar {
      width: 8px;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb {
      background: #c7d2fe;
      border-radius: 8px;
    }
    .custom-scrollbar {
      scrollbar-width: thin;
      scrollbar-color: #c7d2fe #f9fafb;
    }
    .dark .custom-scrollbar::-webkit-scrollbar-thumb {
      background: #374151;
    }
    .dark .custom-scrollbar {
      scrollbar-color: #374151 #1f2937;
    }
  </style>
  <script>
    // Simple animated particles for background
    function animateParticles() {
      const canvas = document.getElementById('bg-canvas');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      let w = window.innerWidth, h = window.innerHeight;
      canvas.width = w; canvas.height = h;
      let particles = Array.from({length: 40}, () => ({
        x: Math.random() * w,
        y: Math.random() * h,
        r: 1.5 + Math.random() * 2.5,
        dx: (Math.random() - 0.5) * 0.5,
        dy: (Math.random() - 0.5) * 0.5,
        o: 0.2 + Math.random() * 0.3
      }));
      function draw() {
        ctx.clearRect(0, 0, w, h);
        for (const p of particles) {
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r, 0, 2 * Math.PI);
          ctx.fillStyle = `rgba(59,130,246,${p.o})`;
          ctx.shadowColor = '#6366f1';
          ctx.shadowBlur = 8;
          ctx.fill();
        }
      }
      function update() {
        for (const p of particles) {
          p.x += p.dx; p.y += p.dy;
          if (p.x < 0 || p.x > w) p.dx *= -1;
          if (p.y < 0 || p.y > h) p.dy *= -1;
        }
      }
      function loop() {
        draw(); update(); requestAnimationFrame(loop);
      }
      loop();
      window.addEventListener('resize', () => {
        w = window.innerWidth; h = window.innerHeight;
        canvas.width = w; canvas.height = h;
      });
    }
    window.addEventListener('DOMContentLoaded', animateParticles);

    // State management for background color (particles always visible)
    function setBgColor(isDark) {
      const bgColorDiv = document.getElementById('bg-color');
      if (!bgColorDiv) return;
      if (isDark) {
        bgColorDiv.style.background = '#111827'; // Tailwind gray-900
      } else {
        bgColorDiv.style.background = '#f3f4f6'; // Tailwind gray-100
      }
    }
    // Initial set on load
    window.addEventListener('DOMContentLoaded', () => {
      setBgColor(document.documentElement.classList.contains('dark'));
    });
    // Theme toggle logic
    const themeToggle = document.getElementById('theme-toggle');
    const themeIcon = document.getElementById('theme-icon');
    const themeIconPath = document.getElementById('theme-icon-path');
    function setTheme(dark) {
      if (dark) {
        document.documentElement.classList.add('dark');
        localStorage.setItem('theme', 'dark');
        // Moon icon
        themeIconPath.setAttribute('d', 'M21 12.79A9 9 0 1111.21 3a7 7 0 109.79 9.79z');
      } else {
        document.documentElement.classList.remove('dark');
        localStorage.setItem('theme', 'light');
        // Sun icon
        themeIconPath.setAttribute('d', 'M12 3v1m0 16v1m8.66-13.66l-.71.71M4.05 19.07l-.71.71M21 12h-1M4 12H3m16.66 5.66l-.71-.71M4.05 4.93l-.71-.71M16 12a4 4 0 11-8 0 4 4 0 018 0z');
      }
    }
    if (themeToggle) {
      themeToggle.addEventListener('click', () => {
        const isDark = document.documentElement.classList.contains('dark');
        setTheme(!isDark);
        setBgColor(!isDark);
        // Manual override
        localStorage.setItem('theme', !isDark ? 'dark' : 'light');
      });
      // Set icon and background on load
      setTheme(document.documentElement.classList.contains('dark'));
      setBgColor(document.documentElement.classList.contains('dark'));
    }
  </script>
  <script src="chatbot.js"></script>
</body>
</html>
